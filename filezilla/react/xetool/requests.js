(function(){var e,n,t,r,i,o;if(!window.Offline)throw new Error("Requests module brought in without offline.js");t=[],o=!1,r=function(e){return Offline.getOption("requests")!==!1?(Offline.trigger("requests:capture"),"down"!==Offline.state&&(o=!0),t.push(e)):void 0},i=function(e){var n,t,r,i,o,f,u,s,a;if(a=e.xhr,f=e.url,o=e.type,u=e.user,r=e.password,n=e.body,Offline.getOption("requests")!==!1){a.abort(),a.open(o,f,!0,u,r),i=a.headers;for(t in i)s=i[t],a.setRequestHeader(t,s);return a.mimeType&&a.overrideMimeType(a.mimeType),a.send(n)}},e=function(){return t=[]},n=function(){var n,r,o,f,u,s,a;if(Offline.getOption("requests")!==!1){for(Offline.trigger("requests:flush"),s={},r=0,f=t.length;f>r;r++)u=t[r],a=u.url.replace(/(\?|&)_=[0-9]+/,function(e,n){return"?"===n?n:""}),Offline.getOption("deDupBody")?(n=u.body,n="[object Object]"===n.toString()?JSON.stringify(n):n.toString(),s[u.type.toUpperCase()+" - "+a+" - "+n]=u):s[u.type.toUpperCase()+" - "+a]=u;for(o in s)u=s[o],i(u);return e()}},setTimeout(function(){return Offline.getOption("requests")!==!1?(Offline.on("confirmed-up",function(){return o?(o=!1,e()):void 0}),Offline.on("up",n),Offline.on("down",function(){return o=!1}),Offline.onXHR(function(e){var n,t,i,o,f;return f=e.xhr,i=e.async,f.offline!==!1&&(o=function(){return r(e)},t=f.send,f.send=function(n){return e.body=n,t.apply(f,arguments)},i)?null===f.onprogress?(f.addEventListener("error",o,!1),f.addEventListener("timeout",o,!1)):(n=f.onreadystatechange,f.onreadystatechange=function(){return 0===f.readyState?o():4===f.readyState&&(0===f.status||f.status>=12e3)&&o(),"function"==typeof n?n.apply(null,arguments):void 0}):void 0}),Offline.requests={flush:n,clear:e}):void 0},0)}).call(this);